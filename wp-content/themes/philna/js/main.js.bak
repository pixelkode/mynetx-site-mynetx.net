var current_url = location.pathname,
	gas_content_iframe = "";
$(function () {
	$("#WLSearchBoxInput").focus(function () {
		$(this).val() == _e.sPrefill && $(this).val("");
		$(this).removeClass("bing")
	}).blur(function () {
		$(this).val() == "" && $(this).val(_e.sPrefill);
		$(this).addClass("bing")
	});
	/*
	$(".excerpt-clickable").live("click", function(e) {
		e.preventDefault();
		var a = $(this).find("h2 a[rel=bookmark]");
		a.length || (a = $(this).parent().find("h2 a[rel=bookmark]"));
		loadswitch(a.attr("href"));
	}).css("cursor", "pointer");
	*/
	$(".excerpt-clickable").click(function(e) {
		e.preventDefault();
		var a = $(this).find("h2 a[rel=bookmark]");
		a.length || (a = $(this).parent().find("h2 a[rel=bookmark]"));
		location.href = a.attr("href");
	}).css("cursor", "pointer");
	$(".section, #languages").live("mouseenter", function () {
		$(".section-box", $(this)).show()
	}).live("mouseleave", function () {
		$(".section-box", $(this)).hide()
	});
	setTimeout(function () {
		$("#WLSearchBoxInput").blur()
	}, 3E3);
	$(".pop-small").live("click", function () {
		window.open(this.href, "pop-small", "height=500,width=630");
		return false
	});
	$(".not-updated a").click(function () {
		location.href = "mailto:me" + String.fromCharCode(64) + "mynetx.net?subject=Author%2FTranslator%20Application";
		return false
	}).css("cursor", "pointer");
	$("<a></a>").addClass("close").attr("href", "#").html("X").click(function () {
		$.post("/", {
			hide_language_bar: true
		});
		$(this).parent().slideUp();
		return false
	}).appendTo(".language-bar");
	(function () {
		function a() {
			if (++b >= $(".sy").length) {
				b = 0
			}
			_e.ltr ? $(".sidebar-imgteaser").animate({
				marginLeft: -b * $(".sidebar-imgteaser").parent().width()
			}, 500) : $(".sidebar-imgteaser").animate({
				marginRight: -b * $(".sidebar-imgteaser").parent().width()
			}, 500)
		}
		var b = 0;
		$(".sidebar-imgteaser").hover(function () {
			clearInterval(c)
		}, function () {
			c = setInterval(a, 1E4)
		}).width($(".sy").length * $(".sidebar-imgteaser").width());
		var c = setInterval(a, 1E4)
	})();
	$("a.bnr-wiki").click(function () {
		_gaq.push(["_trackPageview", "/bnr/wiki"])
	});
	/*
	$('a[href^="http://' + location.host + '"][not(href^="http://' + location.host + '/download/)"]').live("click", function (e) {
		e.preventDefault();
		loadswitch(this.href.substr(location.host.length + 7), $(this).html());
	});
	var loadswitch = function(a, b) {
		if(typeof history.pushState !== 'undefined') {
		    history.pushState({url: a}, b, a);
		    loadpage(a);
  		}
		else {
			location.hash = a;
		}
	};
	var loadpage = function(a) {
		if (a != current_url) {
			current_url = a;
			if ($("#content ins") && $("#content ins").eq(0).html() != null && !gas_content_iframe) {
				gas_content_iframe = $("#content ins").eq(0).html()
			}
			$("body").addClass("load").css("opacity", 0);
			$.ajax({
				type: "GET",
				dataType: "html",
				url: a,
				success: function (a) {
					if (a && a != "") {
						if (gas_content_iframe) {
							for (; a.indexOf('<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"><\/script>') > -1;) {
								a = a.replace('<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"><\/script>', gas_content_iframe)
							}
						}
						$.address.title(/>([^<]*)<\/title/.exec(a)[1]);
						a = $("<div/>").append(a.replace(/<script(.|\s)*?\/script>/g, ""));
						$("#menus").replaceWith(a.find("#menus"));
						$("#languages").replaceWith(a.find("#languages"));
						$("#content").replaceWith(a.find("#content"));
						_gaq.push(["_trackPageview", this.url]);
						$(".excerpt-clickable").css("cursor", "pointer");
						$("body").removeClass("load").css("opacity", 1);
						$("#container").css("visibility", "visible");
						if($("body").scrollTop() > 285)
							$("body").ScrollTo(400);
					}
				},
				error: function (b) {
					$("body").removeClass("load").css("opacity", 1);
					$("#container").css("visibility", "visible");
					if($("body").scrollTop() > 285)
						$("body").ScrollTo(400);
					alert("Error:" + b.status)
				}
			})
		}
	};
	$(window).bind("popstate", function (e) {
	  loadpage(location.href.substr(location.host.length + 7));
	});
	if(typeof history.pushState === 'undefined') {
		$.address.change(function (a) {
			a = a.path;
			loadpage(a);
		})
	}
	*/
});